<button id="signin">Sign in</button>

<script type='text/javascript' src='bower_components/packery/index.js'></script>

<script type='text/javascript' src='https://cdn.firebase.com/v0/firebase.js'></script>
<script type='text/javascript' src='https://cdn.firebase.com/v0/firebase-simple-login.js'></script>
<script type='text/javascript' src='https://login.persona.org/include.js'></script>
<script type='text/javascript'>

var ref = new Firebase('https://mozilla.firebaseio.com/searches/'),
    signedIn = false

var auth = new FirebaseSimpleLogin(ref, function(error, user) {
  console.log('onLoginStateChange', error, user)

  if (error) {
    // an error occurred while attempting login
    console.log(error)
    document.querySelector('#signin').innerHTML = 'Sign In'
  }
  else if (user) {
    // user authenticated with Firebase
    console.log('User ID: ' + user.id + ', Provider: ' + user.provider)
    document.querySelector('#signin').innerHTML = 'Sign Out'
    signedIn = true
  }
  else {
    // user is not logged in
    console.log('not logged in')
    document.querySelector('#signin').innerHTML = 'Sign In'
    signedIn = false
  }
})

function signin() {
  if (!signedIn) {
    auth.login('persona', {
      rememberMe: true
    })
  }
  else {
    auth.logout()
  }
}

document.querySelector('#signin').addEventListener('click', signin, false)
</script>
